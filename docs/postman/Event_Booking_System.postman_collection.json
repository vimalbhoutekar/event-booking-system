{
  "info": {
    "name": "Event Booking System API - Complete",
    "description": "Complete API collection for Event Booking System with OTP-based authentication and optimistic locking.\n\n**Authentication Flow:**\n1. Send OTP to email/mobile\n2. Register with OTP verification\n3. Login to get JWT token\n4. Use token for protected endpoints\n\n**Features:**\n- OTP-based registration\n- JWT Authentication\n- Role-based authorization (USER, ORGANIZER)\n- Event management\n- Booking with concurrency handling\n\n**Setup:**\n1. Set BASE_URL variable\n2. Follow authentication flow to get tokens\n3. Tokens auto-save after successful login",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "BASE_URL",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "USER_TOKEN",
      "value": "",
      "type": "string"
    },
    {
      "key": "ORGANIZER_TOKEN",
      "value": "",
      "type": "string"
    },
    {
      "key": "EVENT_ID",
      "value": "1",
      "type": "string"
    },
    {
      "key": "BOOKING_REFERENCE",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Authentication",
      "item": [
        {
          "name": "Step 1 - Send OTP for Registration",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('OTP sent successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "console.log('✅ OTP sent! Check your email/mobile for verification code.');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"newuser@example.com\",\n  \"type\": \"register\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/send-code",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "send-code"]
            },
            "description": "Send OTP verification code to email for registration.\n\n**Note:** In development, check console logs or email service for OTP code."
          },
          "response": []
        },
        {
          "name": "Step 2 - Register User with OTP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.accessToken) {",
                  "        pm.environment.set('USER_TOKEN', response.accessToken);",
                  "        pm.collectionVariables.set('USER_TOKEN', response.accessToken);",
                  "        console.log('✅ User registered and token saved!');",
                  "    }",
                  "}",
                  "",
                  "pm.test('Registration successful', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstname\": \"John\",\n  \"lastname\": \"Doe\",\n  \"email\": \"newuser@example.com\",\n  \"password\": \"SecurePass@123\",\n  \"country\": \"India\",\n  \"emailVerificationCode\": \"123456\",\n  \"role\": \"USER\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/register",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "register"]
            },
            "description": "Register new user with OTP verification.\n\n**Required:**\n- emailVerificationCode: OTP received in previous step\n- role: USER (default) or ORGANIZER\n\n**Response:**\nReturns JWT token which is auto-saved."
          },
          "response": []
        },
        {
          "name": "Step 3 - Send OTP for Organizer Registration",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('OTP sent successfully', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "console.log('✅ OTP sent for organizer registration!');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"organizer@example.com\",\n  \"type\": \"register\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/send-code",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "send-code"]
            },
            "description": "Send OTP for organizer account registration"
          },
          "response": []
        },
        {
          "name": "Step 4 - Register Organizer with OTP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201 || pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.accessToken) {",
                  "        pm.environment.set('ORGANIZER_TOKEN', response.accessToken);",
                  "        pm.collectionVariables.set('ORGANIZER_TOKEN', response.accessToken);",
                  "        console.log('✅ Organizer registered and token saved!');",
                  "    }",
                  "}",
                  "",
                  "pm.test('Registration successful', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 201]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"firstname\": \"Event\",\n  \"lastname\": \"Organizer\",\n  \"email\": \"organizer@example.com\",\n  \"password\": \"SecurePass@123\",\n  \"country\": \"India\",\n  \"emailVerificationCode\": \"123456\",\n  \"role\": \"ORGANIZER\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/register",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "register"]
            },
            "description": "Register organizer account with ORGANIZER role.\n\n**Important:** Set role to \"ORGANIZER\" to create events."
          },
          "response": []
        },
        {
          "name": "Login as User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.accessToken) {",
                  "        pm.environment.set('USER_TOKEN', response.accessToken);",
                  "        pm.collectionVariables.set('USER_TOKEN', response.accessToken);",
                  "        console.log('✅ User token saved');",
                  "    }",
                  "}",
                  "",
                  "pm.test('Login successful', function () {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.have.property('accessToken');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"newuser@example.com\",\n  \"password\": \"SecurePass@123\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/login",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "login"]
            },
            "description": "Login with USER account credentials.\n\n**Token auto-saves** for subsequent requests."
          },
          "response": []
        },
        {
          "name": "Login as Organizer",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.accessToken) {",
                  "        pm.environment.set('ORGANIZER_TOKEN', response.accessToken);",
                  "        pm.collectionVariables.set('ORGANIZER_TOKEN', response.accessToken);",
                  "        console.log('✅ Organizer token saved');",
                  "    }",
                  "}",
                  "",
                  "pm.test('Login successful', function () {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(pm.response.json()).to.have.property('accessToken');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"organizer@example.com\",\n  \"password\": \"SecurePass@123\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/auth/login",
              "host": ["{{BASE_URL}}"],
              "path": ["auth", "login"]
            },
            "description": "Login with ORGANIZER account credentials.\n\n**Token auto-saves** for event management."
          },
          "response": []
        }
      ],
      "description": "Complete authentication flow with OTP verification"
    },
    {
      "name": "2. Events Management",
      "item": [
        {
          "name": "Get All Events (Public)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "const response = pm.response.json();",
                  "if (response.data && response.data.length > 0) {",
                  "    pm.collectionVariables.set('EVENT_ID', response.data[0].id);",
                  "    console.log('✅ Event ID saved:', response.data[0].id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/events?page=1&limit=10&status=PUBLISHED",
              "host": ["{{BASE_URL}}"],
              "path": ["events"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "status",
                  "value": "PUBLISHED"
                }
              ]
            },
            "description": "Get all events - no authentication required"
          },
          "response": []
        },
        {
          "name": "Get Event by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{BASE_URL}}/events/{{EVENT_ID}}",
              "host": ["{{BASE_URL}}"],
              "path": ["events", "{{EVENT_ID}}"]
            },
            "description": "Get single event details"
          },
          "response": []
        },
        {
          "name": "Create Event (Organizer Only)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.id) {",
                  "        pm.collectionVariables.set('EVENT_ID', response.id);",
                  "        console.log('✅ Event created with ID:', response.id);",
                  "    }",
                  "}",
                  "",
                  "pm.test('Event created successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{ORGANIZER_TOKEN}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Tech Conference 2025\",\n  \"description\": \"Annual technology conference featuring industry leaders\",\n  \"totalSeats\": 100,\n  \"status\": \"PUBLISHED\",\n  \"eventDate\": \"2025-12-31T18:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/events",
              "host": ["{{BASE_URL}}"],
              "path": ["events"]
            },
            "description": "Create new event - requires ORGANIZER role"
          },
          "response": []
        },
        {
          "name": "Get My Events (Organizer)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ORGANIZER_TOKEN}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/events/organizer/my-events?page=1&limit=10",
              "host": ["{{BASE_URL}}"],
              "path": ["events", "organizer", "my-events"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get all events created by logged-in organizer"
          },
          "response": []
        },
        {
          "name": "Update Event",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{ORGANIZER_TOKEN}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Tech Conference 2025 - Updated\",\n  \"totalSeats\": 150\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/events/{{EVENT_ID}}",
              "host": ["{{BASE_URL}}"],
              "path": ["events", "{{EVENT_ID}}"]
            },
            "description": "Update event - only owner can update"
          },
          "response": []
        },
        {
          "name": "Delete Event",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{ORGANIZER_TOKEN}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/events/{{EVENT_ID}}",
              "host": ["{{BASE_URL}}"],
              "path": ["events", "{{EVENT_ID}}"]
            },
            "description": "Delete event - no active bookings allowed"
          },
          "response": []
        }
      ],
      "description": "Event CRUD operations for organizers"
    },
    {
      "name": "3. Bookings",
      "item": [
        {
          "name": "Create Booking",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data) {",
                  "        pm.collectionVariables.set('BOOKING_REFERENCE', response.data.bookingReference);",
                  "        console.log('✅ Booking reference saved:', response.data.bookingReference);",
                  "    }",
                  "}",
                  "",
                  "pm.test('Booking created successfully', function () {",
                  "    pm.response.to.have.status(201);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{USER_TOKEN}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"eventId\": {{EVENT_ID}},\n  \"seatCount\": 3\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/bookings",
              "host": ["{{BASE_URL}}"],
              "path": ["bookings"]
            },
            "description": "Book seats with optimistic locking"
          },
          "response": []
        },
        {
          "name": "Get My Bookings",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER_TOKEN}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/bookings?page=1&limit=10",
              "host": ["{{BASE_URL}}"],
              "path": ["bookings"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get all bookings for logged-in user"
          },
          "response": []
        },
        {
          "name": "Get Booking by Reference",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER_TOKEN}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/bookings/{{BOOKING_REFERENCE}}",
              "host": ["{{BASE_URL}}"],
              "path": ["bookings", "{{BOOKING_REFERENCE}}"]
            },
            "description": "Get booking details by reference"
          },
          "response": []
        },
        {
          "name": "Cancel Booking",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER_TOKEN}}"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/bookings/{{BOOKING_REFERENCE}}",
              "host": ["{{BASE_URL}}"],
              "path": ["bookings", "{{BOOKING_REFERENCE}}"]
            },
            "description": "Cancel booking and release seats"
          },
          "response": []
        }
      ],
      "description": "Booking operations with concurrency handling"
    }
  ]
}